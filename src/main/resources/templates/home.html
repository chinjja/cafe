<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/layout}">

	<div layout:fragment="content" class="container-fluid">
		<div class="page-header">
			<h1>Welcome to...</h1>
		</div>
		<div th:if="${user}">
			<form method="POST" th:action="@{/logout}" id="logoutForm" class="row-cols-1">
				<span class="form-label mb-3" th:text="${user.username}"></span>
				<input type="submit" value="Logout" class="btn btn-outline-primary" />
			</form>
			<hr />
			<div class="page-header">
				<h1>New Issue</h1>
			</div>
			<form method="POST" th:action="@{/issues}" th:object="${issueData}" id="createIssue" class="row-cols-1">
				<div class="form-group mb-3">
					<label for="summary" class="form-label">Summary</label>
					<input type="text" th:field="*{summary}" class="form-control" autocomplete="off" />
					<div th:if="${#fields.hasErrors('summary')}" class="alert alert-danger" role="alert" th:errors="*{summary}"></div>
				</div>
				<div class="form-group mb-3">
					<label for="contents" class="form-label">Contents</label>
					<textarea th:field="*{contents}" class="form-control" autocomplete="off" rows=4></textarea>
					<div th:if="${#fields.hasErrors('contents')}" class="alert alert-danger" role="alert" th:errors="*{contents}"></div>
				</div>
				<input type="submit" class="btn btn-outline-primary"/>
			</form>
		</div>
		<div th:unless="${user}" class="row-cols-1">
			<form method="POST" th:action="@{/login}" id="loginForm" class="row-cols-1">
				<div class="form-group mb-3">
					<label for="username" class="form-label">Username</label>
					<input type="text" name="username" id="username" class="form-control"/>
				</div>
				<div class="form-group mb-3">
					<label for="password" class="form-label">Password</label>
					<input type="password" name="password" id="password" class="form-control"/>
				</div>
				<input type="submit" value="Login" class="btn btn-outline-primary"/>
			</form>
			<hr/>
			<a th:href="@{/register}" class="btn btn-outline-primary">Register</a>
		</div>
		<hr/>
		<div class="page-header">
			<h1>Issue List</h1>
		</div>
		<table class="table table-bordered">
			<thead>
				<tr>
					<th>ID</th>
					<th>Summary</th>
					<th class="d-none d-md-block">Contents</th>
					<th>Created At</th>
					<th>Username</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="issue : ${issueList}">
					<td>
						<a th:href="@{/issues/} + ${issue.id}" th:text="${issue.id}"></a>
					</td>
					<td th:text="${issue.data.summary}"></td>
					<td th:text="${issue.data.contents}" class="d-none d-md-block"></td>
					<td th:text="${issue.createdAt}"></td>
					<td>
						<a th:href="@{/users/} + ${issue.user.username}" th:text="${issue.user.username}"></a>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</html>